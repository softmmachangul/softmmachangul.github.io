<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>맥 한글 변환 도구 · Mac Hangul Conversion Tool</title>
<meta name="description" content="맥(NFD)에서 온 한글을 NFC로 안전 변환. URL/Latin1 깨짐 자동 보정, 클립보드 복사, 코드포인트 인스펙터, 파일 드래그&드롭, PWA 오프라인 지원.">
<link rel="canonical" href="https://example.com/mac-hangul-conversion-tool">
<meta name="robots" content="index,follow">
<meta name="theme-color" content="#0c0f18">

<!-- Open Graph -->
<meta property="og:type" content="website">
<meta property="og:title" content="맥 한글 변환 도구 · Mac Hangul Conversion Tool">
<meta property="og:description" content="맥(NFD)에서 온 한글을 NFC로 안전 변환. URL/Latin1 깨짐 보정, 클립보드 복사, 파일/모바일 지원.">
<meta property="og:url" content="https://example.com/mac-hangul-conversion-tool">
<meta property="og:locale" content="ko_KR">
<meta property="og:locale:alternate" content="en_US">

<!-- Twitter -->
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="맥 한글 변환 도구 · Mac Hangul Conversion Tool">
<meta name="twitter:description" content="맥(NFD)에서 온 한글을 NFC로 안전 변환. URL/Latin1 깨짐 보정, 클립보드 복사, 파일/모바일 지원.">

<link rel="manifest" href="manifest.webmanifest">
<link rel="icon" href="favicon.ico">

<style>
  :root{
    --bg:#0c0f18; --fg:#e9edf6; --muted:#a2abc2; --card:#12172a; --line:#1e2744; --accent:#5fb3ff;
    --good:#2ec27e; --warn:#ffb86c; --bad:#ff6b6b; --btn:#22335c; --btnb:#2c4173; --btnh:#2b3f70;
  }
  /* Light theme variables */
  :root.light{
    --bg:#ffffff; --fg:#111827; --muted:#6b7280; --card:#f8fafc; --line:#e5e7eb; --accent:#2563eb;
    --good:#16a34a; --warn:#f59e0b; --bad:#ef4444; --btn:#e5e7eb; --btnb:#d1d5db; --btnh:#dbeafe;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;background:var(--bg);color:var(--fg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,sans-serif;line-height:1.55}
  header{padding:18px 14px;border-bottom:1px solid var(--line)}
  header .row{display:flex;gap:12px;align-items:center;justify-content:space-between;max-width:1120px;margin:0 auto}
  header h1{margin:0;font-size:18px}
  header .controls{display:flex;gap:8px;flex-wrap:wrap}
  .pill{display:inline-block;background:#1b2547;border:1px solid #2b3c6f;color:#bcd3ff;border-radius:999px;padding:3px 8px;font-size:12px}
  .pill.light{background:#eef2ff;border-color:#dbeafe;color:#1e40af}
  main{max-width:1120px;margin:0 auto;padding:18px;display:grid;gap:16px}
  .grid{display:grid;grid-template-columns:1fr;gap:16px}
  @media(min-width:1000px){ .grid{grid-template-columns:1fr 1fr} }
  .card{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:14px}
  .card h2{margin:0 0 8px 0;font-size:16px;color:var(--muted);font-weight:600}
  textarea,.mono{width:100%;min-height:220px;background:color-mix(in srgb, var(--bg) 92%, black 8%);border:1px solid var(--line);border-radius:12px;color:var(--fg);
                 padding:12px;font-size:15px;resize:vertical;line-height:1.6}
  .mono{white-space:pre-wrap;overflow:auto}
  .bar{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
  button{background:var(--btn);border:1px solid var(--btnb);color:var(--fg);border-radius:12px;padding:10px 14px;cursor:pointer;font-size:15px}
  button:hover{background:var(--btnh)}
  .accent{background:var(--accent);border-color:var(--accent);color:#fff}
  .hint{font-size:12.5px;color:var(--muted);margin-top:8px}
  .badge{display:inline-block;border-radius:8px;padding:2px 8px;font-size:12px;border:1px solid var(--line);background:color-mix(in srgb, var(--bg) 96%, black 4%)}
  .two{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  .kv{display:grid;grid-template-columns:max-content 1fr;gap:8px 14px;font-size:13px}
  .kv div:nth-child(odd){color:var(--muted)}
  .drop{border:2px dashed var(--line);border-radius:12px;padding:10px;text-align:center;margin-top:10px;color:var(--muted)}
  .toolbar{display:flex;gap:8px;align-items:center}
  .toggle{display:inline-flex;gap:6px;align-items:center;background:var(--card);border:1px solid var(--line);padding:6px 10px;border-radius:999px}
  .select{padding:8px 10px;border-radius:10px;border:1px solid var(--line);background:var(--card);color:var(--fg)}
  /* Mobile large buttons */
  @media(max-width:640px){
    button{width:100%;padding:14px 16px;font-size:16px;border-radius:14px}
    .two{grid-template-columns:1fr}
  }
</style>

<!-- JSON-LD: WebApplication -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebApplication",
  "name": "맥 한글 변환 도구",
  "alternateName": "Mac Hangul Conversion Tool",
  "url": "https://example.com/mac-hangul-conversion-tool",
  "applicationCategory": "Utility",
  "operatingSystem": "Web",
  "description": "맥(NFD)에서 온 한글을 NFC로 안전 변환하는 온라인 도구. URL/Latin1 깨짐 자동 보정, 클립보드 복사, 파일 드래그&드롭, 오프라인(PWA) 지원.",
  "offers": { "@type": "Offer", "price": "0", "priceCurrency": "KRW" }
}
</script>
</head>
<body>
  <header>
    <div class="row">
      <h1 id="site-title">맥 한글 변환 도구 <span class="pill" id="site-sub">Safe · Pro</span></h1>
      <div class="controls">
        <div class="toggle">
          <label for="lang">🌐</label>
          <select id="lang" class="select" aria-label="Language">
            <option value="ko" selected>한국어</option>
            <option value="en">English</option>
          </select>
        </div>
        <button id="theme-toggle" aria-label="Toggle theme">🌙 Dark</button>
        <button id="install" aria-label="Install PWA" style="display:none">⤓ 설치</button>
      </div>
    </div>
  </header>

  <main>
    <section class="grid">
      <div class="card">
        <h2 data-i18n="input_title">입력</h2>
        <textarea id="input" placeholder="여기에 맥에서 복사한 텍스트(NFD/깨짐 포함)를 붙여넣으세요."></textarea>
        <div class="bar">
          <button id="btn-paste" data-i18n="paste">붙여넣기</button>
          <button id="btn-clear" data-i18n="clear">지우기</button>
          <button id="btn-swap" data-i18n="swap">입력 ↔ 출력 교환</button>
        </div>
        <div class="drop" id="drop" data-i18n="drop">여기로 .txt 파일을 드래그&드롭하거나 선택<input type="file" id="file" accept=".txt" style="display:block;margin:8px auto 0"></div>
        <div class="hint" data-i18n="auto_hint">변경 시 우측 결과가 자동으로 갱신됩니다.</div>
      </div>

      <div class="card">
        <h2 data-i18n="output_title">결과</h2>
        <div class="two">
          <div>
            <div class="badge" data-i18n="display_mode">표시용</div>
            <div id="output" class="mono" aria-label="변환 결과"></div>
            <div class="bar">
              <button class="accent" id="btn-copy" data-i18n="copy_result">📋 결과 복사</button>
              <button id="btn-select" data-i18n="select_all">전체 선택</button>
              <button id="btn-download" data-i18n="download_txt">.txt 다운로드</button>
            </div>
          </div>
          <div>
            <div class="badge" data-i18n="copy_variant">선택 변환 복사</div>
            <div class="bar">
              <button id="btn-copy-nfc" data-i18n="copy_nfc">NFC로 복사</button>
              <button id="btn-copy-nfd" data-i18n="copy_nfd">NFD로 복사</button>
              <button id="btn-copy-raw" data-i18n="copy_raw">원본 그대로 복사</button>
            </div>
            <div class="hint" data-i18n="copy_hint">※ 화면 표시와 별개로, 원하는 정규화 형태로 직접 복사할 수 있습니다.</div>
          </div>
        </div>
        <div class="hint" id="why">경로: -</div>
      </div>
    </section>

    <section class="card">
      <h2 data-i18n="mode_title">모드 및 옵션</h2>
      <div class="bar">
        <label class="toggle"><input type="checkbox" id="mode-safe" checked> <span data-i18n="safe_mode">안전 모드(자동 판단)</span></label>
        <label class="toggle"><input type="checkbox" id="opt-nfc" checked> <span>NFC</span></label>
        <label class="toggle"><input type="checkbox" id="opt-url" checked> <span>URL</span></label>
        <label class="toggle"><input type="checkbox" id="opt-latin1" checked> <span>Latin1</span></label>
        <label class="toggle"><input type="checkbox" id="opt-manual" checked> <span data-i18n="manual_fix">수동 보정</span></label>
        <button id="btn-try-all" data-i18n="try_all">모든 방식 점수 비교</button>
        <button id="btn-original" data-i18n="show_original">원본 표시</button>
      </div>
      <div class="kv" id="stats"></div>
    </section>

    <section class="card">
      <h2 data-i18n="inspector_title">코드포인트 인스펙터</h2>
      <div class="two">
        <div>
          <div class="badge" data-i18n="original">원본</div>
          <div id="ins-src" class="mono" style="min-height:140px"></div>
        </div>
        <div>
          <div class="badge" data-i18n="result">결과</div>
          <div id="ins-out" class="mono" style="min-height:140px"></div>
        </div>
      </div>
      <div class="hint" data-i18n="inspector_hint">각 문자에 대해 U+코드와 한글 여부를 표시합니다.</div>
    </section>

    <div class="hint" data-i18n="privacy_note">※ 모든 처리는 브라우저 내에서만 수행됩니다. (네트워크 전송 없음)</div>
  </main>

<script>
// --- Theme Toggle (Dark/Light) ---
const root = document.documentElement;
const themeBtn = document.getElementById('theme-toggle');
function applyTheme(mode){
  if(mode==='light'){ root.classList.add('light'); themeBtn.textContent='🌚 Light'; }
  else { root.classList.remove('light'); themeBtn.textContent='🌙 Dark'; }
  localStorage.setItem('theme', mode);
}
const savedTheme = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark');
applyTheme(savedTheme);
themeBtn.addEventListener('click', ()=> applyTheme(root.classList.contains('light') ? 'dark' : 'light'));

// --- i18n (KO/EN toggle) ---
const i18n = {
  ko: {
    site_title: '맥 한글 변환 도구', sub: 'Safe · Pro',
    input_title:'입력', paste:'붙여넣기', clear:'지우기', swap:'입력 ↔ 출력 교환',
    drop:'여기로 .txt 파일을 드래그&드롭하거나 선택', auto_hint:'변경 시 우측 결과가 자동으로 갱신됩니다.',
    output_title:'결과', display_mode:'표시용', copy_result:'📋 결과 복사', select_all:'전체 선택', download_txt:'.txt 다운로드',
    copy_variant:'선택 변환 복사', copy_nfc:'NFC로 복사', copy_nfd:'NFD로 복사', copy_raw:'원본 그대로 복사', copy_hint:'※ 화면 표시와 별개로, 원하는 정규화 형태로 직접 복사할 수 있습니다.',
    mode_title:'모드 및 옵션', safe_mode:'안전 모드(자동 판단)', manual_fix:'수동 보정', try_all:'모든 방식 점수 비교', show_original:'원본 표시',
    inspector_title:'코드포인트 인스펙터', original:'원본', result:'결과', inspector_hint:'각 문자에 대해 U+코드와 한글 여부를 표시합니다.',
    privacy_note:'※ 모든 처리는 브라우저 내에서만 수행됩니다. (네트워크 전송 없음)',
    reason_prefix:'경로: ',
    meta_title:'맥 한글 변환 도구 · Mac Hangul Conversion Tool',
    meta_desc:'맥(NFD)에서 온 한글을 NFC로 안전 변환. URL/Latin1 깨짐 자동 보정, 클립보드 복사, 코드포인트 인스펙터, 파일 드래그&드롭, PWA 오프라인 지원.'
  },
  en: {
    site_title:'Mac Hangul Conversion Tool', sub:'Safe · Pro',
    input_title:'Input', paste:'Paste', clear:'Clear', swap:'Swap In/Out',
    drop:'Drag & drop or choose a .txt file here', auto_hint:'The result updates automatically when the input changes.',
    output_title:'Output', display_mode:'Display', copy_result:'📋 Copy Result', select_all:'Select All', download_txt:'Download .txt',
    copy_variant:'Copy with normalization', copy_nfc:'Copy as NFC', copy_nfd:'Copy as NFD', copy_raw:'Copy Raw', copy_hint:'Copy in your desired normalization independent from the display.',
    mode_title:'Mode & Options', safe_mode:'Safe mode (auto)', manual_fix:'Manual fix', try_all:'Compare all methods', show_original:'Show Original',
    inspector_title:'Codepoint Inspector', original:'Original', result:'Result', inspector_hint:'Displays U+code and Hangul flag for each character.',
    privacy_note:'All processing is done locally in your browser. No network transfer.',
    reason_prefix:'Path: ',
    meta_title:'Mac Hangul Conversion Tool · 맥 한글 변환 도구',
    meta_desc:'Safely convert Mac (NFD) Hangul to NFC. Auto-fix URL/Latin1 mojibake, clipboard copy, codepoint inspector, drag & drop, PWA offline.'
  }
};
const langSel = document.getElementById('lang');
function applyLang(lang){
  const dict = i18n[lang] || i18n.ko;
  document.getElementById('site-title').innerHTML = dict.site_title + ' <span class="pill">'+dict.sub+'</span>';
  document.title = dict.meta_title;
  document.querySelector('meta[name="description"]').setAttribute('content', dict.meta_desc);
  document.documentElement.setAttribute('lang', lang);
  // text nodes with data-i18n
  document.querySelectorAll('[data-i18n]').forEach(el => {
    const key = el.getAttribute('data-i18n');
    if(dict[key]) el.textContent = dict[key];
  });
  localStorage.setItem('lang', lang);
}
applyLang(localStorage.getItem('lang') || 'ko');
langSel.value = localStorage.getItem('lang') || 'ko';
langSel.addEventListener('change', e => applyLang(e.target.value));

// --- Core conversion (Safe+Pro merged) ---
const $id = id => document.getElementById(id);
const outputEl = $id('output');
const whyEl = $id('why');
const insSrcEl = $id('ins-src');
const insOutEl = $id('ins-out');
const statsEl = $id('stats');

const NFD_JAMO = /[\u1100-\u11FF\u3130-\u318F]/;
const HANGUL_SYL = /[\uAC00-\uD7A3]/;
const MOJIBAKE_SEQ = /Ã|Â|¤|�/;
const PERCENT_ENC = /%[0-9A-Fa-f]{2}/;

function looksPureNFD(s){ return NFD_JAMO.test(s) && !HANGUL_SYL.test(s); }
function looksMojibakeLatin1(s){ return MOJIBAKE_SEQ.test(s); }
function looksPercentEncoded(s){ return PERCENT_ENC.test(s); }

function urlDecode(str){
  try{ return decodeURIComponent(str.replace(/\+/g,'%20')); }
  catch(e){ return str.replace(/%[0-9A-Fa-f]{2}/g, m=>{ try{return decodeURIComponent(m);}catch{ return m; } }); }
}
function toLatin1Bytes(str){
  const bytes = new Uint8Array(str.length);
  for(let i=0;i<str.length;i++){ bytes[i] = str.charCodeAt(i) & 0xFF; }
  return bytes;
}
function latin1ToUtf8(str){
  try{ return new TextDecoder('utf-8',{fatal:false}).decode(toLatin1Bytes(str)); }
  catch(e){ return str; }
}
const manualPairs = [
  ['Ã„','Ä'], ['Ã–','Ö'], ['Ãœ','Ü'], ['Ã§','ç'], ['Ã±','ñ'],
  ['Ã¡','á'], ['Ã©','é'], ['Ã³','ó'], ['Ã¨','è'], ['Ãµ','õ'],
  ['Ã«','ë'], ['Ã¬','ì'], ['Ã­','í'], ['Ãª','ê'], ['Ã©','é']
];
function manualFix(s){
  let t = s;
  for(const [a,b] of manualPairs){ t = t.split(a).join(b); }
  return latin1ToUtf8(t);
}

function pipeline(src, opts){
  let out = src;
  if(opts.url) out = urlDecode(out);
  if(opts.latin1) out = latin1ToUtf8(out);
  if(opts.manual) out = manualFix(out);
  if(opts.nfc) out = out.normalize('NFC');
  return out;
}
function hangulCount(s){ const m = s.match(/[\u1100-\u11FF\u3130-\u318F\uAC00-\uD7A3]/g); return m ? m.length : 0; }
function codepointInfo(s){
  const arr = [];
  for(const ch of s){
    const cp = ch.codePointAt(0).toString(16).toUpperCase().padStart(4,'0');
    const isHangul = /[\uAC00-\uD7AF]/.test(ch) || /[\u1100-\u11FF]/.test(ch) || /[\u3130-\u318F]/.test(ch);
    arr.push(`${ch === '\n' ? '⏎' : ch}  —  U+${cp}${isHangul ? ' (Hangul)' : ''}`);
  }
  return arr.join('\n');
}
function score(s){
  const h = hangulCount(s);
  const bad = (s.match(/\uFFFD/g)||[]).length;
  const len = s.trim().length;
  return h*10 - bad*2 + Math.min(len, 50)/50;
}
function bestOfAll(src){
  const variants = [];
  const combos = [
    {nfc:true, url:true, latin1:true, manual:true, label:'모두 적용'},
    {nfc:true, url:false, latin1:true, manual:true, label:'URL 제외'},
    {nfc:true, url:true, latin1:false, manual:true, label:'Latin1 제외'},
    {nfc:true, url:true, latin1:true, manual:false, label:'수동 제외'},
    {nfc:true, url:false, latin1:false, manual:false, label:'NFC만'},
    {nfc:false, url:true, latin1:true, manual:true, label:'정규화 제외'}
  ];
  for(const c of combos){
    const text = pipeline(src, c);
    variants.push({label:c.label, text, score:score(text)});
  }
  variants.sort((a,b)=>b.score-a.score);
  return variants;
}

const modeSafe = $id('mode-safe');
const optNFC = $id('opt-nfc');
const optURL = $id('opt-url');
const optLAT = $id('opt-latin1');
const optMAN = $id('opt-manual');
const inputEl = $id('input');

function render(){
  const src = inputEl.value;
  let out, reason;
  const lang = localStorage.getItem('lang') || 'ko';
  const prefix = i18n[lang].reason_prefix;

  if(modeSafe.checked){
    if(looksPureNFD(src)){ out = src.normalize('NFC'); reason='NFD→NFC'; }
    else if(looksPercentEncoded(src)){ out = urlDecode(src).normalize('NFC'); reason='URL→NFC'; }
    else if(looksMojibakeLatin1(src)){ out = latin1ToUtf8(src).normalize('NFC'); reason='Latin1→UTF-8→NFC'; }
    else { out = (()=>{ try{return src.normalize('NFC');}catch{return src;} })(); reason='NFC only'; }
    whyEl.textContent = prefix + reason + ' (Safe)';
  }else{
    const opts = { nfc:optNFC.checked, url:optURL.checked, latin1:optLAT.checked, manual:optMAN.checked };
    out = pipeline(src, opts);
    whyEl.textContent = prefix + 'Manual pipeline';
  }

  outputEl.textContent = out;
  statsEl.innerHTML = `
    <div>입력 길이</div><div>${src.length.toLocaleString()}</div>
    <div>입력 한글 수</div><div>${hangulCount(src).toLocaleString()}</div>
    <div>출력 길이</div><div>${out.length.toLocaleString()}</div>
    <div>출력 한글 수</div><div>${hangulCount(out).toLocaleString()}</div>
  `;
  insSrcEl.textContent = codepointInfo(src);
  insOutEl.textContent = codepointInfo(out);
}

document.getElementById('btn-paste').addEventListener('click', async () => {
  try{ const txt = await navigator.clipboard.readText(); inputEl.value = txt; render(); }
  catch{ alert((localStorage.getItem('lang')||'ko')==='ko'?'클립보드 접근이 차단되었습니다.':'Clipboard access blocked.'); }
});
document.getElementById('btn-clear').addEventListener('click', ()=>{ inputEl.value=''; render(); });
document.getElementById('btn-swap').addEventListener('click', ()=>{
  const tmp = inputEl.value; inputEl.value = outputEl.textContent || ''; outputEl.textContent = tmp; render();
});
document.getElementById('btn-copy').addEventListener('click', async ()=>{
  const text = outputEl.textContent || '';
  if(!text.trim()){ alert((localStorage.getItem('lang')||'ko')==='ko'?'복사할 결과가 없습니다.':'Nothing to copy.'); return; }
  try{ await navigator.clipboard.writeText(text); alert('✅'); }catch{
    const sel = window.getSelection(); const range = document.createRange();
    range.selectNodeContents(outputEl); sel.removeAllRanges(); sel.addRange(range);
    const ok = document.execCommand('copy'); sel.removeAllRanges();
    alert(ok ? '✅' : '❌');
  }
});
document.getElementById('btn-select').addEventListener('click', ()=>{
  const sel = window.getSelection(); const range = document.createRange();
  range.selectNodeContents(outputEl); sel.removeAllRanges(); sel.addRange(range);
});
document.getElementById('btn-download').addEventListener('click', ()=>{
  const blob = new Blob([outputEl.textContent||''], {type:'text/plain;charset=utf-8'});
  const url = URL.createObjectURL(blob); const a = document.createElement('a');
  a.href=url; a.download='converted_ko.txt'; a.click(); URL.revokeObjectURL(url);
});
document.getElementById('btn-copy-nfc').addEventListener('click', async ()=>{
  const text = (outputEl.textContent||'').normalize('NFC'); if(!text){ alert(''); return; }
  await navigator.clipboard.writeText(text).then(()=>alert('✅')).catch(()=>alert('❌'));
});
document.getElementById('btn-copy-nfd').addEventListener('click', async ()=>{
  const text = (outputEl.textContent||'').normalize('NFD'); if(!text){ alert(''); return; }
  await navigator.clipboard.writeText(text).then(()=>alert('✅')).catch(()=>alert('❌'));
});
document.getElementById('btn-copy-raw').addEventListener('click', async ()=>{
  const text = inputEl.value || ''; if(!text){ alert(''); return; }
  await navigator.clipboard.writeText(text).then(()=>alert('✅')).catch(()=>alert('❌'));
});
document.getElementById('btn-original').addEventListener('click', ()=>{ outputEl.textContent = inputEl.value; render(); });
document.getElementById('btn-try-all').addEventListener('click', ()=>{
  const src = inputEl.value; const arr = bestOfAll(src);
  const msg = arr.map(x=>`• ${x.label} — ${x.score.toFixed(2)}`).join('\n');
  alert(msg);
});
// File input & drop
const fileInput = document.getElementById('file'); const drop = document.getElementById('drop');
fileInput.addEventListener('change', async (e)=>{ const f = e.target.files[0]; if(!f) return; const txt = await f.text(); inputEl.value = txt; render(); });
['dragenter','dragover'].forEach(ev=>drop.addEventListener(ev, e=>{ e.preventDefault(); drop.style.background='color-mix(in srgb, var(--bg) 92%, black 8%)'; }));
['dragleave','drop'].forEach(ev=>drop.addEventListener(ev, e=>{ e.preventDefault(); drop.style.background=''; }));
drop.addEventListener('drop', async (e)=>{ const f = e.dataTransfer.files[0]; if(!f) return; const txt = await f.text(); inputEl.value = txt; render(); });

// Re-render on option changes
['mode-safe','opt-nfc','opt-url','opt-latin1','opt-manual'].forEach(id => document.getElementById(id).addEventListener('change', render));
document.getElementById('input').addEventListener('input', render);

// PWA install prompt
let deferredPrompt;
window.addEventListener('beforeinstallprompt', (e) => {
  e.preventDefault();
  deferredPrompt = e;
  document.getElementById('install').style.display = 'inline-block';
});
document.getElementById('install').addEventListener('click', async () => {
  if(!deferredPrompt) return;
  deferredPrompt.prompt();
  await deferredPrompt.userChoice;
  deferredPrompt = null;
  document.getElementById('install').style.display = 'none';
});

// Register service worker
if('serviceWorker' in navigator){
  window.addEventListener('load', ()=> navigator.serviceWorker.register('service-worker.js'));
}

// First render
render();
</script>
</body>
</html>
